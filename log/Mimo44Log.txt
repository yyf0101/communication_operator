C:\Users\frank\AppData\Local\Programs\Python\Python38\python.exe D:/communication_operator/opeForTmpTest/Mimo44.py
============================================================
4×4 MIMO链路仿真启动
参数配置：FFT=1024, SCS=15.0kHz, SNR=15dB
============================================================

[1/4] 发送端处理...
[发送端] 信号功率: 901.7659, 总长度: 122112采样点
[发送端] 天线0前10比特: [[0 0]
 [1 1]
 [1 0]
 [1 0]
 [0 0]
 [0 0]
 [1 1]
 [0 1]
 [1 1]
 [0 1]]
[发送端] 对应QPSK符号索引: [0 3 2 1 1 1 3 1 0 0]

[2/4] 信道传输...
[信道] 信号功率: 3609.2007, 噪声功率: 114.132949, SNR: 15.0dB

[3/4] 接收端处理...
[接收端] 数字前端旁路(FIR关闭)，信号功率: 3726.8791
[同步-STF] peak_idx=48, best_off=1, peak/median=1.00
[同步-CFO] cfo_norm≈0, 跳过补偿
[同步-LTF] skip (STF判别力不足)
[同步-微调] offset 1 -> 0, mse=4.523
[同步-全局模型扫描] best_off=0, mse=4.523, current_off=0, current_mse=4.523
[同步-全局模型扫描] 改进不足，保持现有offset
[诊断-线性] 当前偏移0子载波相对误差: mean=0.619, p90=1.931, p99=9.272
[诊断-同步扫描] 最佳delta=0 样本, 模型MSE=4.7053
[诊断-同步扫描] 前5低MSE偏移: [(0, 4.705263554880632), (-32, 6.604680609533661), (-12, 6.656155783696007), (-28, 6.660460153709121), (-38, 6.664156708954298)]
[诊断-条件数] 样本=52, min=3.4, median=6.4, p90=9.2, max=75.3
[同步-回退] 条件不满足(Δ或改进不足) 不执行修正
[信道估计] 使用理想信道 (调试模式)
[均衡] 第0符号MSE: 0.205295 (越小越好)
[均衡] 发送符号前5个: [ 0.707+0.707j  0.707-0.707j -0.707-0.707j -0.707-0.707j  0.707+0.707j]
[均衡] 均衡后前5个: [ 0.988+0.946j  0.396-0.404j -0.681-0.58j  -0.944-0.409j  0.285+0.824j]
[判决] 天线0第0符号前10对比特: [[0 0]
 [1 1]
 [1 0]
 [1 0]
 [0 0]
 [0 0]
 [1 1]
 [0 1]
 [1 1]
 [0 1]]

[4/4] 计算BER...
[BER] 天线0的BER: 0.012037
[BER] 天线1的BER: 0.027282
[BER] 天线2的BER: 0.042634
[BER] 天线3的BER: 0.024972

============================================================
仿真结果
============================================================
平均BER：0.026731
链路状态：✅ 跑通
============================================================

Process finished with exit code 0
